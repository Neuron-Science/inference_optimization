<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.1 (20251006.0113)
 -->
<!-- Title: FlashAttention Pages: 1 -->
<svg width="663pt" height="246pt"
 viewBox="0.00 0.00 663.00 246.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 242.25)">
<title>FlashAttention</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-242.25 659,-242.25 659,4 -4,4"/>
<text xml:space="preserve" text-anchor="middle" x="327.5" y="-220.95" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="14.00">Flash Attention (With Fusion)</text>
<g id="clust1" class="cluster">
<title>cluster_hbm</title>
<path fill="#d4edda" stroke="#388e3c" d="M295,-8C295,-8 467,-8 467,-8 473,-8 479,-14 479,-20 479,-20 479,-82 479,-82 479,-88 473,-94 467,-94 467,-94 295,-94 295,-94 289,-94 283,-88 283,-82 283,-82 283,-20 283,-20 283,-14 289,-8 295,-8"/>
<text xml:space="preserve" text-anchor="middle" x="381" y="-13.55" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="11.00" fill="#388e3c">HBM (Device Memory)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_onchip</title>
<path fill="#fff9c4" stroke="#f9a825" d="M20,-121.25C20,-121.25 635,-121.25 635,-121.25 641,-121.25 647,-127.25 647,-133.25 647,-133.25 647,-195.25 647,-195.25 647,-201.25 641,-207.25 635,-207.25 635,-207.25 20,-207.25 20,-207.25 14,-207.25 8,-201.25 8,-195.25 8,-195.25 8,-133.25 8,-133.25 8,-127.25 14,-121.25 20,-121.25"/>
<text xml:space="preserve" text-anchor="middle" x="327.5" y="-126.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="11.00" fill="#f57f17">On&#45;Chip (SRAM)</text>
</g>
<!-- QKV -->
<g id="node1" class="node">
<title>QKV</title>
<path fill="#a8d5ba" stroke="black" d="M340,-79C340,-79 310,-79 310,-79 304,-79 298,-73 298,-67 298,-67 298,-55 298,-55 298,-49 304,-43 310,-43 310,-43 340,-43 340,-43 346,-43 352,-49 352,-55 352,-55 352,-67 352,-67 352,-73 346,-79 340,-79"/>
<text xml:space="preserve" text-anchor="middle" x="325" y="-56.55" font-family="Helvetica,sans-Serif" font-size="11.00">Q, K, V</text>
</g>
<!-- O_out -->
<g id="node2" class="node">
<title>O_out</title>
<path fill="#a8d5ba" stroke="black" d="M452,-79C452,-79 422,-79 422,-79 416,-79 410,-73 410,-67 410,-67 410,-55 410,-55 410,-49 416,-43 422,-43 422,-43 452,-43 452,-43 458,-43 464,-49 464,-55 464,-55 464,-67 464,-67 464,-73 458,-79 452,-79"/>
<text xml:space="preserve" text-anchor="middle" x="437" y="-56.55" font-family="Helvetica,sans-Serif" font-size="11.00">O</text>
</g>
<!-- QKV&#45;&gt;O_out -->
<!-- op1 -->
<g id="node3" class="node">
<title>op1</title>
<ellipse fill="#ffecb3" stroke="black" cx="66" cy="-174.25" rx="43.09" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="66" y="-170.93" font-family="Helvetica,sans-Serif" font-size="11.00">S = Q × Kᵀ</text>
</g>
<!-- QKV&#45;&gt;op1 -->
<g id="edge6" class="edge">
<title>QKV&#45;&gt;op1</title>
<path fill="none" stroke="black" stroke-width="2" d="M297.51,-69.55C262.97,-79.47 202.26,-98.35 153,-121.25 133.84,-130.16 113.51,-142.15 97.33,-152.37"/>
<polygon fill="black" stroke="black" stroke-width="2" points="96.91,-148.48 90.38,-156.83 100.69,-154.38 96.91,-148.48"/>
<text xml:space="preserve" text-anchor="middle" x="203.33" y="-103.75" font-family="Helvetica,sans-Serif" font-size="10.00">load</text>
</g>
<!-- S -->
<g id="node4" class="node">
<title>S</title>
<path fill="#ffe082" stroke="black" d="M209,-192.25C209,-192.25 179,-192.25 179,-192.25 173,-192.25 167,-186.25 167,-180.25 167,-180.25 167,-168.25 167,-168.25 167,-162.25 173,-156.25 179,-156.25 179,-156.25 209,-156.25 209,-156.25 215,-156.25 221,-162.25 221,-168.25 221,-168.25 221,-180.25 221,-180.25 221,-186.25 215,-192.25 209,-192.25"/>
<text xml:space="preserve" text-anchor="middle" x="194" y="-169.8" font-family="Helvetica,sans-Serif" font-size="11.00">S</text>
</g>
<!-- op1&#45;&gt;S -->
<g id="edge2" class="edge">
<title>op1&#45;&gt;S</title>
<path fill="none" stroke="black" d="M109.5,-174.25C124.82,-174.25 140.13,-174.25 155.45,-174.25"/>
<polygon fill="black" stroke="black" points="155.09,-177.75 165.09,-174.25 155.09,-170.75 155.09,-177.75"/>
</g>
<!-- op2 -->
<g id="node5" class="node">
<title>op2</title>
<ellipse fill="#ffecb3" stroke="black" cx="332" cy="-174.25" rx="53.37" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="332" y="-169.8" font-family="Helvetica,sans-Serif" font-size="11.00">P = softmax(S)</text>
</g>
<!-- S&#45;&gt;op2 -->
<g id="edge3" class="edge">
<title>S&#45;&gt;op2</title>
<path fill="none" stroke="black" d="M221.49,-174.25C236.78,-174.25 252.06,-174.25 267.34,-174.25"/>
<polygon fill="black" stroke="black" points="266.96,-177.75 276.96,-174.25 266.96,-170.75 266.96,-177.75"/>
</g>
<!-- P -->
<g id="node6" class="node">
<title>P</title>
<path fill="#ffe082" stroke="black" d="M485,-192.25C485,-192.25 455,-192.25 455,-192.25 449,-192.25 443,-186.25 443,-180.25 443,-180.25 443,-168.25 443,-168.25 443,-162.25 449,-156.25 455,-156.25 455,-156.25 485,-156.25 485,-156.25 491,-156.25 497,-162.25 497,-168.25 497,-168.25 497,-180.25 497,-180.25 497,-186.25 491,-192.25 485,-192.25"/>
<text xml:space="preserve" text-anchor="middle" x="470" y="-169.8" font-family="Helvetica,sans-Serif" font-size="11.00">P</text>
</g>
<!-- op2&#45;&gt;P -->
<g id="edge4" class="edge">
<title>op2&#45;&gt;P</title>
<path fill="none" stroke="black" d="M385.64,-174.25C400.93,-174.25 416.22,-174.25 431.51,-174.25"/>
<polygon fill="black" stroke="black" points="431.13,-177.75 441.13,-174.25 431.13,-170.75 431.13,-177.75"/>
</g>
<!-- op3 -->
<g id="node7" class="node">
<title>op3</title>
<ellipse fill="#ffecb3" stroke="black" cx="593" cy="-174.25" rx="38.94" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="593" y="-169.8" font-family="Helvetica,sans-Serif" font-size="11.00">O = P × V</text>
</g>
<!-- P&#45;&gt;op3 -->
<g id="edge5" class="edge">
<title>P&#45;&gt;op3</title>
<path fill="none" stroke="black" d="M497.39,-174.25C512.37,-174.25 527.35,-174.25 542.33,-174.25"/>
<polygon fill="black" stroke="black" points="542.27,-177.75 552.27,-174.25 542.27,-170.75 542.27,-177.75"/>
</g>
<!-- op3&#45;&gt;O_out -->
<g id="edge7" class="edge">
<title>op3&#45;&gt;O_out</title>
<path fill="none" stroke="black" stroke-width="2" d="M572.77,-158.82C546.86,-140.35 501.62,-108.08 470.53,-85.91"/>
<polygon fill="black" stroke="black" stroke-width="2" points="474.01,-84.1 463.84,-81.14 469.95,-89.8 474.01,-84.1"/>
<text xml:space="preserve" text-anchor="middle" x="516.53" y="-103.75" font-family="Helvetica,sans-Serif" font-size="10.00">store</text>
</g>
</g>
</svg>
